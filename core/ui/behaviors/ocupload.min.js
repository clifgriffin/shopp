!function(t){t.fn.upload=function(e){return e=t.extend({name:"file",enctype:"multipart/form-data",action:"",accept:!1,maxfilesize:!1,autoSubmit:!0,onSubmit:function(){},onComplete:function(){},onSelect:function(){},params:{}},e),new t.ocupload(this,e)},t.ocupload=function(e,n){var a=this,i=(new Date).getTime().toString().substr(8),o=t('<iframe id="iframe'+i+'" name="iframe'+i+'" />').css({display:"none"}),r=t('<form method="post" enctype="'+n.enctype+'" action="'+n.action+'" target="iframe'+i+'" />').css({margin:0,padding:0}).submit(function(t){t&&t.stopPropagation()}),c=t('<input name="'+n.name+'" type="file" />').css({position:"absolute",display:"block",opacity:0}),m=e.parent(),p=e.wrap("<div />").parent().appendTo(t("body"));elementHeight=e.outerHeight(!0),elementWidth=e.outerWidth(!0),p.appendTo(m),n.maxfilesize&&t('<input type="hidden" name="MAX_FILE_SIZE" value="'+n.maxfilesize+'" />').appendTo(r),r.append(c),e.after(r).after(o),p=e.parent().css({position:"relative",height:elementHeight+"px",width:elementWidth+"px",overflow:"hidden",cursor:"pointer",margin:0,padding:0}),c.css({width:elementWidth+"px",height:elementHeight+"px",marginTop:-elementHeight+"px",marginLeft:"0px",fontSize:"2em"}),c.change(function(){if(""==this.value)return!1;if(t.ua.msie){if(this.firedChange)return this.firedChange=!1;this.firedChange=!0}a.onSelect(),a.autoSubmit&&a.submit()}),t.extend(this,{autoSubmit:!0,onSubmit:n.onSubmit,onComplete:n.onComplete,onSelect:n.onSelect,filename:function(){return c.attr("value")},params:function(e){var e=!!e&&e;return e&&(n.params=t.extend(n.params,e)),n.params},name:function(t){var t=!!t&&t;return t&&c.attr("name",value),c.attr("name")},action:function(t){var t=!!t&&t;return t&&r.attr("action",t),r.attr("action")},enctype:function(t){var t=!!t&&t;return t&&r.attr("enctype",t),r.attr("enctype")},accept:function(t){var t=!!t&&t;return t&&r.attr("accept",t),r.attr("accept")},set:function(e,n){function i(t,e){switch(t){default:throw new Error("[jQuery.ocupload.set] '"+t+"' is an invalid option.");case"name":a.name(e);break;case"action":a.action(e);break;case"enctype":a.enctype(e);break;case"params":a.params(e);break;case"autoSubmit":a.autoSubmit=e;break;case"onSubmit":a.onSubmit=e;break;case"onComplete":a.onComplete=e;break;case"onSelect":a.onSelect=e}}var n=!!n&&n;n?i(e,n):t.each(e,function(t,e){i(t,e)})},submit:function(){this.onSubmit();var e=r.attr("action").split("?"),i=e[0],c=e[1]?e[1].split("&"):[],m={},p=!1;t.each(c,function(t,e){var a=e.split("=");2!=a.length||n.params[a[0]]||(m[a[0]]=a[1])}),p=i+"?"+(""!=t.param(m)?t.param(m)+"&":"")+t.param(n.params),r[0].setAttribute("action",p),r.submit(),o.unbind().load(function(){var e=document.getElementById(o.attr("name")),n=t(e.contentWindow.document.body).text();a.onComplete(n)})}})}}(jQuery);